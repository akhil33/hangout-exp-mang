<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0a0f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ExpenseFlow">
    <meta name="description" content="Modern expense management for restaurants">
    
    <title>ExpenseFlow - Expense Management</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <!-- Modern Font: DM Sans -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --color-background: #0a0a0f;
            --color-surface: #16161d;
            --color-surface-elevated: #1e1e28;
            --color-border: #2a2a35;
            --color-border-hover: #3a3a45;
            
            --color-primary: #00d4aa;
            --color-primary-glow: rgba(0, 212, 170, 0.15);
            --color-primary-dark: #00b894;
            
            --color-accent-1: #ff6b9d;
            --color-accent-2: #ffd93d;
            --color-accent-3: #6c5ce7;
            
            --color-text-primary: #ffffff;
            --color-text-secondary: #a0a0b2;
            --color-text-tertiary: #6a6a7a;
            
            --color-success: #00d4aa;
            --color-warning: #ffd93d;
            --color-pending: #6c5ce7;
            --color-error: #ff6b9d;
            
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
            --shadow-glow: 0 0 20px var(--color-primary-glow);
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            
            --font-display: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'Space Mono', monospace;
            
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 400ms cubic-bezier(0.4, 0, 0.2, 1);
            
            --backdrop-blur: blur(12px);
            
            /* Mobile-specific variables */
            --mobile-padding: 16px;
            --mobile-header-height: 60px;
            --mobile-bottom-nav-height: 70px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: var(--font-display);
            background: var(--color-background);
            color: var(--color-text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            overscroll-behavior-y: none;
        }

        /* Animated background gradient mesh */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(108, 92, 231, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 212, 170, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 80%, rgba(255, 107, 157, 0.1) 0%, transparent 50%);
            animation: meshMove 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes meshMove {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(5%, 10%) rotate(5deg); }
            66% { transform: translate(-5%, 5%) rotate(-5deg); }
        }

        .app-container {
            display: flex;
            height: 100vh;
            position: relative;
        }

        /* Desktop Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(22, 22, 29, 0.7);
            backdrop-filter: var(--backdrop-blur);
            border-right: 1px solid var(--color-border);
            display: flex;
            flex-direction: column;
            padding: 32px 0;
            position: relative;
            z-index: 10;
            transition: transform var(--transition-base);
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 1px;
            height: 100%;
            background: linear-gradient(180deg, 
                transparent 0%, 
                var(--color-primary) 50%, 
                transparent 100%);
            opacity: 0.3;
        }

        /* Mobile Bottom Navigation */
        .mobile-bottom-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(22, 22, 29, 0.95);
            backdrop-filter: var(--backdrop-blur);
            border-top: 1px solid var(--color-border);
            padding: 8px 8px calc(8px + env(safe-area-inset-bottom));
            z-index: 100;
            height: calc(var(--mobile-bottom-nav-height) + env(safe-area-inset-bottom));
        }

        .mobile-bottom-nav-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 4px;
            height: 100%;
        }

        .mobile-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 4px;
            padding: 8px;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-base);
            color: var(--color-text-tertiary);
            font-size: 11px;
            font-weight: 600;
            text-align: center;
            position: relative;
        }

        .mobile-nav-item.active {
            background: var(--color-primary-glow);
            color: var(--color-primary);
        }

        .mobile-nav-item .nav-icon {
            font-size: 24px;
        }

        /* Mobile Header */
        .mobile-header {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(22, 22, 29, 0.95);
            backdrop-filter: var(--backdrop-blur);
            border-bottom: 1px solid var(--color-border);
            padding: 16px var(--mobile-padding);
            padding-top: calc(16px + env(safe-area-inset-top));
            z-index: 90;
            height: calc(var(--mobile-header-height) + env(safe-area-inset-top));
        }

        .mobile-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .mobile-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            font-weight: 700;
        }

        .mobile-logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent-3));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .logo {
            padding: 0 32px 32px;
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: -0.02em;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent-3));
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 0 20px rgba(0, 212, 170, 0.3);
        }

        .nav-item {
            padding: 16px 32px;
            display: flex;
            align-items: center;
            gap: 14px;
            cursor: pointer;
            color: var(--color-text-secondary);
            transition: all var(--transition-base);
            position: relative;
            font-weight: 500;
            font-size: 15px;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 0;
            background: var(--color-primary);
            transition: height var(--transition-base);
            border-radius: 0 3px 3px 0;
        }

        .nav-item:hover {
            color: var(--color-text-primary);
            background: rgba(255, 255, 255, 0.03);
        }

        .nav-item.active {
            color: var(--color-primary);
            background: var(--color-primary-glow);
        }

        .nav-item.active::before {
            height: 28px;
        }

        .nav-icon {
            font-size: 20px;
            transition: transform var(--transition-base);
        }

        .nav-item:hover .nav-icon {
            transform: scale(1.1);
        }

        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 48px;
            position: relative;
        }

        /* Custom scrollbar */
        .main-content::-webkit-scrollbar {
            width: 8px;
        }

        .main-content::-webkit-scrollbar-track {
            background: var(--color-surface);
        }

        .main-content::-webkit-scrollbar-thumb {
            background: var(--color-border);
            border-radius: 4px;
        }

        .main-content::-webkit-scrollbar-thumb:hover {
            background: var(--color-border-hover);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 48px;
            animation: slideDown 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header-title h1 {
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--color-text-primary), var(--color-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.03em;
            margin-bottom: 8px;
        }

        .header-title p {
            color: var(--color-text-secondary);
            font-size: 16px;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: var(--radius-md);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-base);
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: var(--font-display);
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width var(--transition-slow), height var(--transition-slow);
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
            color: var(--color-background);
            box-shadow: 0 4px 16px rgba(0, 212, 170, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 212, 170, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--color-surface-elevated);
            color: var(--color-text-primary);
            border: 1px solid var(--color-border);
        }

        .btn-secondary:hover {
            border-color: var(--color-primary);
            background: var(--color-primary-glow);
        }

        .view-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 48px;
            background: var(--color-surface);
            padding: 6px;
            border-radius: var(--radius-md);
            width: fit-content;
            border: 1px solid var(--color-border);
            animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) 0.1s backwards;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab {
            padding: 12px 32px;
            border: none;
            background: transparent;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: var(--color-text-secondary);
            transition: all var(--transition-base);
            position: relative;
            font-family: var(--font-display);
        }

        .tab.active {
            background: var(--color-primary);
            color: var(--color-background);
            box-shadow: 0 2px 8px rgba(0, 212, 170, 0.3);
        }

        .tab:hover:not(.active) {
            color: var(--color-text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 24px;
            margin-bottom: 48px;
        }

        .stat-card {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: 28px;
            position: relative;
            overflow: hidden;
            transition: all var(--transition-base);
            animation: fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) backwards;
        }

        .stat-card:nth-child(1) { animation-delay: 0.2s; }
        .stat-card:nth-child(2) { animation-delay: 0.3s; }
        .stat-card:nth-child(3) { animation-delay: 0.4s; }
        .stat-card:nth-child(4) { animation-delay: 0.5s; }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--color-primary), transparent);
            opacity: 0;
            transition: opacity var(--transition-base);
        }

        .stat-card:hover {
            border-color: var(--color-primary);
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-label {
            font-size: 13px;
            color: var(--color-text-tertiary);
            margin-bottom: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .stat-value {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 12px;
            font-family: var(--font-mono);
            letter-spacing: -0.02em;
            background: linear-gradient(135deg, var(--color-text-primary), var(--color-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-subtext {
            font-size: 14px;
            color: var(--color-success);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .stat-subtext.warning {
            color: var(--color-warning);
        }

        .widgets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 24px;
            margin-bottom: 48px;
        }

        .widget {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: 32px;
            transition: all var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .widget::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at top right, var(--color-primary-glow), transparent 70%);
            opacity: 0;
            transition: opacity var(--transition-base);
            pointer-events: none;
        }

        .widget:hover::after {
            opacity: 1;
        }

        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .widget-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--color-text-primary);
            letter-spacing: -0.01em;
        }

        .widget-amount {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 12px;
            font-family: var(--font-mono);
            color: var(--color-primary);
        }

        .widget-subtitle {
            font-size: 14px;
            color: var(--color-text-tertiary);
            margin-bottom: 24px;
        }

        .expand-btn {
            background: var(--color-surface-elevated);
            border: 1px solid var(--color-border);
            cursor: pointer;
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            color: var(--color-text-secondary);
            transition: all var(--transition-base);
            font-size: 14px;
            font-weight: 600;
        }

        .expand-btn:hover {
            color: var(--color-primary);
            border-color: var(--color-primary);
            background: var(--color-primary-glow);
        }

        .expense-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .expense-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: var(--color-surface-elevated);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            transition: all var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .expense-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--color-primary);
            transform: scaleY(0);
            transition: transform var(--transition-base);
        }

        .expense-item:hover {
            border-color: var(--color-primary);
            transform: translateX(4px);
        }

        .expense-item:hover::before {
            transform: scaleY(1);
        }

        .expense-info {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex: 1;
            min-width: 0;
        }

        .expense-name {
            font-weight: 600;
            font-size: 15px;
            color: var(--color-text-primary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .expense-meta {
            font-size: 13px;
            color: var(--color-text-tertiary);
            font-family: var(--font-mono);
        }

        .expense-amount {
            font-weight: 700;
            font-size: 18px;
            font-family: var(--font-mono);
            color: var(--color-primary);
        }

        .expense-actions {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-shrink: 0;
        }

        .badge {
            padding: 6px 14px;
            border-radius: var(--radius-sm);
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            white-space: nowrap;
        }

        .badge-success {
            background: rgba(0, 212, 170, 0.15);
            color: var(--color-success);
            border: 1px solid var(--color-success);
        }

        .badge-warning {
            background: rgba(255, 217, 61, 0.15);
            color: var(--color-warning);
            border: 1px solid var(--color-warning);
        }

        .badge-pending {
            background: rgba(108, 92, 231, 0.15);
            color: var(--color-pending);
            border: 1px solid var(--color-pending);
        }

        .approve-btn {
            padding: 8px 18px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            background: var(--color-primary);
            color: var(--color-background);
            transition: all var(--transition-base);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            white-space: nowrap;
        }

        .approve-btn:active {
            transform: scale(0.95);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 12px;
            background: var(--color-surface);
            padding: 32px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--color-border);
        }

        .calendar-header {
            font-weight: 700;
            padding: 16px;
            text-align: center;
            color: var(--color-text-secondary);
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .calendar-day {
            aspect-ratio: 1;
            padding: 16px;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-base);
            display: flex;
            flex-direction: column;
            gap: 6px;
            background: var(--color-surface-elevated);
            position: relative;
            overflow: hidden;
        }

        .calendar-day::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, var(--color-primary-glow), transparent);
            opacity: 0;
            transition: opacity var(--transition-base);
        }

        .calendar-day:hover {
            border-color: var(--color-primary);
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .calendar-day:hover::before {
            opacity: 1;
        }

        .calendar-day.has-expense {
            background: var(--color-primary-glow);
            border-color: var(--color-primary);
        }

        .day-number {
            font-weight: 700;
            font-size: 16px;
            color: var(--color-text-primary);
            position: relative;
            z-index: 1;
        }

        .day-amount {
            font-size: 12px;
            color: var(--color-primary);
            font-weight: 700;
            font-family: var(--font-mono);
            position: relative;
            z-index: 1;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 10, 15, 0.9);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeInOverlay 0.3s ease-out;
            padding: var(--mobile-padding);
        }

        @keyframes fadeInOverlay {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-xl);
            padding: 40px;
            max-width: 700px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: slideUpModal 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes slideUpModal {
            from {
                opacity: 0;
                transform: translateY(40px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 32px;
            padding-bottom: 24px;
            border-bottom: 1px solid var(--color-border);
        }

        .modal-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--color-text-primary);
            letter-spacing: -0.02em;
        }

        .modal-close {
            background: var(--color-surface-elevated);
            border: 1px solid var(--color-border);
            font-size: 24px;
            cursor: pointer;
            color: var(--color-text-secondary);
            padding: 8px 14px;
            border-radius: var(--radius-sm);
            transition: all var(--transition-base);
            line-height: 1;
            flex-shrink: 0;
        }

        .modal-close:hover {
            color: var(--color-error);
            border-color: var(--color-error);
            background: rgba(255, 107, 157, 0.1);
            transform: rotate(90deg);
        }

        .chart-container {
            background: var(--color-surface);
            padding: 32px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--color-border);
            margin-bottom: 48px;
        }

        .chart-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 32px;
            border-bottom: 1px solid var(--color-border);
            flex-wrap: wrap;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .chart-tab {
            padding: 14px 24px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: var(--color-text-secondary);
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
            transition: all var(--transition-base);
            font-family: var(--font-display);
            white-space: nowrap;
        }

        .chart-tab.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .chart-tab:hover:not(.active) {
            color: var(--color-text-primary);
        }

        .date-range-picker {
            display: flex;
            gap: 16px;
            align-items: flex-end;
            margin-bottom: 32px;
            padding: 24px;
            background: var(--color-surface-elevated);
            border-radius: var(--radius-md);
            border: 1px solid var(--color-border);
            flex-wrap: wrap;
        }

        .date-input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
            min-width: 180px;
        }

        .date-input-label {
            font-size: 13px;
            font-weight: 600;
            color: var(--color-text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--color-text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            font-size: 15px;
            transition: all var(--transition-base);
            background: var(--color-surface-elevated);
            color: var(--color-text-primary);
            font-family: var(--font-display);
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px var(--color-primary-glow);
        }

        .user-badge {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            background: var(--color-surface-elevated);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 600;
        }

        .role-indicator {
            padding: 4px 10px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent-3));
            color: var(--color-background);
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 0.05em;
        }

        /* Pulse animation for pending items */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        /* Install prompt */
        .install-prompt {
            position: fixed;
            bottom: calc(var(--mobile-bottom-nav-height) + 16px + env(safe-area-inset-bottom));
            left: var(--mobile-padding);
            right: var(--mobile-padding);
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent-3));
            padding: 16px 20px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            box-shadow: var(--shadow-lg);
            z-index: 1001;
            animation: slideUpInstall 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes slideUpInstall {
            from {
                opacity: 0;
                transform: translateY(100%);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .install-prompt-text {
            flex: 1;
        }

        .install-prompt-title {
            font-weight: 700;
            font-size: 15px;
            margin-bottom: 4px;
            color: var(--color-background);
        }

        .install-prompt-subtitle {
            font-size: 13px;
            opacity: 0.9;
            color: var(--color-background);
        }

        .install-btn {
            padding: 10px 20px;
            background: var(--color-background);
            color: var(--color-primary);
            border: none;
            border-radius: var(--radius-sm);
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
        }

        .install-close {
            background: rgba(0, 0, 0, 0.2);
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        /* ============================================
           MOBILE RESPONSIVE STYLES
        ============================================ */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .mobile-bottom-nav {
                display: block;
            }

            .mobile-header {
                display: block;
            }

            .main-content {
                padding: calc(var(--mobile-header-height) + env(safe-area-inset-top) + 24px) var(--mobile-padding) calc(var(--mobile-bottom-nav-height) + env(safe-area-inset-bottom) + 24px);
            }

            .header {
                margin-bottom: 32px;
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .header-title h1 {
                font-size: 28px;
            }

            .header-title p {
                font-size: 14px;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .view-tabs {
                width: 100%;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .tab {
                padding: 12px 24px;
                font-size: 14px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 16px;
                margin-bottom: 32px;
            }

            .stat-card {
                padding: 20px;
            }

            .stat-value {
                font-size: 32px;
            }

            .widgets-grid {
                grid-template-columns: 1fr;
                gap: 16px;
                margin-bottom: 32px;
            }

            .widget {
                padding: 20px;
            }

            .widget-amount {
                font-size: 28px;
            }

            .expense-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
                padding: 16px;
            }

            .expense-actions {
                width: 100%;
                justify-content: space-between;
            }

            .expense-name {
                white-space: normal;
            }

            .calendar-grid {
                gap: 8px;
                padding: 16px;
            }

            .calendar-header {
                padding: 8px;
                font-size: 11px;
            }

            .calendar-day {
                padding: 8px;
                min-height: 60px;
            }

            .day-number {
                font-size: 14px;
            }

            .day-amount {
                font-size: 10px;
            }

            .modal-content {
                padding: 24px;
                max-height: calc(100vh - 80px);
                margin: var(--mobile-padding);
            }

            .modal-title {
                font-size: 22px;
            }

            .chart-container {
                padding: 20px;
            }

            .chart-tab {
                padding: 12px 20px;
                font-size: 14px;
            }

            .date-range-picker {
                padding: 16px;
            }

            .date-input-group {
                min-width: 100%;
            }
        }

        /* Small phones */
        @media (max-width: 375px) {
            .header-title h1 {
                font-size: 24px;
            }

            .stat-value {
                font-size: 28px;
            }

            .widget-amount {
                font-size: 24px;
            }

            .expense-amount {
                font-size: 16px;
            }

            .mobile-nav-item {
                font-size: 10px;
            }

            .mobile-nav-item .nav-icon {
                font-size: 20px;
            }
        }

        /* Landscape mode on mobile */
        @media (max-height: 500px) and (orientation: landscape) {
            .main-content {
                padding-top: calc(var(--mobile-header-height) + 16px);
                padding-bottom: calc(var(--mobile-bottom-nav-height) + 16px);
            }

            .header {
                margin-bottom: 24px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Tablet */
        @media (min-width: 769px) and (max-width: 1024px) {
            .sidebar {
                width: 240px;
            }

            .main-content {
                padding: 32px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .widgets-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Large screens */
        @media (min-width: 1600px) {
            .main-content {
                padding: 64px;
            }

            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }

            .widgets-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Print styles */
        @media print {
            .sidebar,
            .mobile-bottom-nav,
            .mobile-header,
            .btn,
            .expand-btn,
            .approve-btn {
                display: none !important;
            }

            .main-content {
                padding: 0;
            }

            body {
                background: white;
                color: black;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Initialize Supabase
        const SUPABASE_URL = 'https://ygimmhtjlzdmpiggynxl.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_STSX1sCANMQpf6zzglnRiQ_er6WqEbu';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Sample expense data
        const initialExpenses = [
            // January 2026 - Week 1 (Dec 29 - Jan 4)
            { id: 1, name: "Rent Payment", amount: 5000, dueDate: "2026-01-01", category: "Rent", frequency: "monthly", status: "paid" },
            { id: 2, name: "Liquor Supplier - ABC Distributors", amount: 4200, dueDate: "2026-01-02", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 3, name: "Food Supplier - Fresh Foods Ltd", amount: 3100, dueDate: "2026-01-03", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 4, name: "Staff Payroll", amount: 12000, dueDate: "2026-01-04", category: "Payroll", frequency: "weekly", status: "paid" },
            
            // January 2026 - Week 2 (Jan 5-11) - CURRENT WEEK
            { id: 5, name: "Insurance Premium", amount: 1200, dueDate: "2026-01-05", category: "Insurance", frequency: "monthly", status: "paid" },
            { id: 6, name: "Utilities - Hydro One", amount: 850, dueDate: "2026-01-08", category: "Utilities", frequency: "monthly", status: "paid" },
            { id: 7, name: "Liquor Supplier - ABC Distributors", amount: 4500, dueDate: "2026-01-09", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 8, name: "Food Supplier - Fresh Foods Ltd", amount: 3200, dueDate: "2026-01-10", category: "Inventory", frequency: "weekly", status: "approved" },
            { id: 9, name: "Staff Payroll", amount: 12500, dueDate: "2026-01-11", category: "Payroll", frequency: "weekly", status: "pending" },
            
            // January 2026 - Week 3 (Jan 12-18) - NEXT WEEK
            { id: 10, name: "Cleaning Service", amount: 600, dueDate: "2026-01-12", category: "Services", frequency: "weekly", status: "pending" },
            { id: 11, name: "Liquor Supplier - ABC Distributors", amount: 4300, dueDate: "2026-01-14", category: "Inventory", frequency: "weekly", status: "pending" },
            { id: 12, name: "Food Supplier - Fresh Foods Ltd", amount: 3400, dueDate: "2026-01-15", category: "Inventory", frequency: "weekly", status: "pending" },
            { id: 13, name: "Equipment Lease", amount: 800, dueDate: "2026-01-15", category: "Equipment", frequency: "monthly", status: "pending" },
            { id: 14, name: "Staff Payroll", amount: 12200, dueDate: "2026-01-18", category: "Payroll", frequency: "weekly", status: "pending" },
            
            // January 2026 - Week 4 (Jan 19-25)
            { id: 15, name: "Marketing - Social Media", amount: 500, dueDate: "2026-01-20", category: "Marketing", frequency: "monthly", status: "pending" },
            { id: 16, name: "Liquor Supplier - ABC Distributors", amount: 4400, dueDate: "2026-01-21", category: "Inventory", frequency: "weekly", status: "pending" },
            { id: 17, name: "Food Supplier - Fresh Foods Ltd", amount: 3300, dueDate: "2026-01-22", category: "Inventory", frequency: "weekly", status: "pending" },
            { id: 18, name: "Staff Payroll", amount: 12300, dueDate: "2026-01-25", category: "Payroll", frequency: "weekly", status: "pending" },
            
            // December 2025 - Week 4 (Dec 22-28) - LAST WEEK
            { id: 19, name: "Liquor Supplier - ABC Distributors", amount: 4100, dueDate: "2025-12-23", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 20, name: "Food Supplier - Fresh Foods Ltd", amount: 3000, dueDate: "2025-12-24", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 21, name: "Staff Payroll", amount: 11800, dueDate: "2025-12-27", category: "Payroll", frequency: "weekly", status: "paid" },
            
            // December 2025 - Week 3 (Dec 15-21)
            { id: 22, name: "Liquor Supplier - ABC Distributors", amount: 3900, dueDate: "2025-12-16", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 23, name: "Food Supplier - Fresh Foods Ltd", amount: 2900, dueDate: "2025-12-17", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 24, name: "Staff Payroll", amount: 11500, dueDate: "2025-12-20", category: "Payroll", frequency: "weekly", status: "paid" },
            { id: 25, name: "Equipment Maintenance", amount: 450, dueDate: "2025-12-18", category: "Equipment", frequency: "monthly", status: "paid" },
            
            // December 2025 - Week 2 (Dec 8-14)
            { id: 26, name: "Liquor Supplier - ABC Distributors", amount: 4000, dueDate: "2025-12-09", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 27, name: "Food Supplier - Fresh Foods Ltd", amount: 2800, dueDate: "2025-12-10", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 28, name: "Staff Payroll", amount: 11600, dueDate: "2025-12-13", category: "Payroll", frequency: "weekly", status: "paid" },
            { id: 29, name: "Utilities - Hydro One", amount: 820, dueDate: "2025-12-08", category: "Utilities", frequency: "monthly", status: "paid" },
            
            // December 2025 - Week 1 (Dec 1-7)
            { id: 30, name: "Rent Payment", amount: 5000, dueDate: "2025-12-01", category: "Rent", frequency: "monthly", status: "paid" },
            { id: 31, name: "Liquor Supplier - ABC Distributors", amount: 3800, dueDate: "2025-12-02", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 32, name: "Food Supplier - Fresh Foods Ltd", amount: 2700, dueDate: "2025-12-03", category: "Inventory", frequency: "weekly", status: "paid" },
            { id: 33, name: "Staff Payroll", amount: 11400, dueDate: "2025-12-06", category: "Payroll", frequency: "weekly", status: "paid" },
            { id: 34, name: "Insurance Premium", amount: 1200, dueDate: "2025-12-05", category: "Insurance", frequency: "monthly", status: "paid" },
            
            // November 2025 expenses
            { id: 35, name: "Rent Payment", amount: 5000, dueDate: "2025-11-01", category: "Rent", frequency: "monthly", status: "paid" },
            { id: 36, name: "Insurance Premium", amount: 1200, dueDate: "2025-11-05", category: "Insurance", frequency: "monthly", status: "paid" },
            { id: 37, name: "Utilities - Hydro One", amount: 780, dueDate: "2025-11-08", category: "Utilities", frequency: "monthly", status: "paid" },
            { id: 38, name: "Marketing Campaign", amount: 1500, dueDate: "2025-11-15", category: "Marketing", frequency: "monthly", status: "paid" },
            { id: 39, name: "Equipment Lease", amount: 800, dueDate: "2025-11-15", category: "Equipment", frequency: "monthly", status: "paid" },
            
            // October 2025 expenses
            { id: 40, name: "Rent Payment", amount: 5000, dueDate: "2025-10-01", category: "Rent", frequency: "monthly", status: "paid" },
            { id: 41, name: "Insurance Premium", amount: 1200, dueDate: "2025-10-05", category: "Insurance", frequency: "monthly", status: "paid" },
            { id: 42, name: "Utilities - Hydro One", amount: 760, dueDate: "2025-10-08", category: "Utilities", frequency: "monthly", status: "paid" },
            { id: 43, name: "Equipment Maintenance", amount: 650, dueDate: "2025-10-12", category: "Equipment", frequency: "quarterly", status: "paid" },
        ];

        const LoginView = ({ onLogin }) => {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');

            const handleLogin = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                const { data, error } = await supabase.auth.signInWithPassword({
                    email,
                    password
                });

                if (error) {
                    setError(error.message);
                } else {
                    onLogin(data.user);
                }
                setIsLoading(false);
            };

            return (
                <div style={{ 
                    display: 'flex', 
                    justifyContent: 'center', 
                    alignItems: 'center', 
                    minHeight: '100vh',
                    padding: '20px'
                }}>
                    <div className="widget" style={{ maxWidth: '400px', width: '100%' }}>
                        <h2 style={{ marginBottom: '24px' }}>Login to ExpenseFlow</h2>
                        <form onSubmit={handleLogin}>
                            <div className="form-group">
                                <label className="form-label">Email</label>
                                <input 
                                    type="email"
                                    className="form-input"
                                    value={email}
                                    onChange={(e) => setEmail(e.target.value)}
                                    required
                                />
                            </div>
                            <div className="form-group">
                                <label className="form-label">Password</label>
                                <input 
                                    type="password"
                                    className="form-input"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    required
                                />
                            </div>
                            {error && (
                                <div style={{ 
                                    color: 'var(--color-error)', 
                                    marginBottom: '16px',
                                    fontSize: '14px'
                                }}>
                                    {error}
                                </div>
                            )}
                            <button 
                                type="submit" 
                                className="btn btn-primary" 
                                style={{ width: '100%' }}
                                disabled={isLoading}
                            >
                                {isLoading ? 'Logging in...' : 'Login'}
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [user, setUser] = useState(null);
            const [isLoading, setIsLoading] = useState(true);
            const [currentView, setCurrentView] = useState('dashboard');
            const [userRole, setUserRole] = useState('manager');
            const [timeView, setTimeView] = useState('weekly');
            const [expenses, setExpenses] = useState(initialExpenses);
            const [expandedWidgets, setExpandedWidgets] = useState({});
            const [showInstallPrompt, setShowInstallPrompt] = useState(false);
            const [deferredPrompt, setDeferredPrompt] = useState(null);

            // Check if user is logged in and listen for auth changes
            useEffect(() => {
                // Check if user is logged in
                supabase.auth.getSession().then(({ data: { session } }) => {
                    setUser(session?.user ?? null);
                    setIsLoading(false);
                });

                // Listen for auth changes
                const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {
                    setUser(session?.user ?? null);
                });

                return () => subscription.unsubscribe();
            }, []);

            useEffect(() => {
                if (userRole === 'staff' && currentView === 'analytics') {
                    setCurrentView('dashboard');
                }
            }, [userRole, currentView]);

            // PWA Install Prompt
            useEffect(() => {
                const handleBeforeInstallPrompt = (e) => {
                    e.preventDefault();
                    setDeferredPrompt(e);
                    setShowInstallPrompt(true);
                };

                window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

                return () => {
                    window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
                };
            }, []);

            const handleInstallClick = async () => {
                if (!deferredPrompt) return;

                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                
                console.log(`User response to install prompt: ${outcome}`);
                setDeferredPrompt(null);
                setShowInstallPrompt(false);
            };

            const toggleWidget = (widget) => {
                setExpandedWidgets(prev => ({
                    ...prev,
                    [widget]: !prev[widget]
                }));
            };

            const approveExpense = (id) => {
                setExpenses(prev => prev.map(exp => 
                    exp.id === id ? { ...exp, status: 'approved' } : exp
                ));
            };

            const getWeekExpenses = (weekOffset) => {
                const today = new Date('2026-01-10');
                const weekStart = new Date(today);
                weekStart.setDate(today.getDate() - today.getDay() + (weekOffset * 7));
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 6);

                return expenses.filter(exp => {
                    const expDate = new Date(exp.dueDate);
                    return expDate >= weekStart && expDate <= weekEnd;
                });
            };

            const lastWeekExpenses = getWeekExpenses(-1);
            const thisWeekExpenses = getWeekExpenses(0);
            const nextWeekExpenses = getWeekExpenses(1);

            const lastWeekPaid = lastWeekExpenses.filter(e => e.status === 'paid');
            const lastWeekTotal = lastWeekExpenses.reduce((sum, e) => sum + e.amount, 0);
            const lastWeekPaidTotal = lastWeekPaid.reduce((sum, e) => sum + e.amount, 0);
            const thisWeekTotal = thisWeekExpenses.reduce((sum, e) => sum + e.amount, 0);
            const nextWeekTotal = nextWeekExpenses.reduce((sum, e) => sum + e.amount, 0);
            const pendingApprovals = expenses.filter(e => e.status === 'pending').length;

            if (isLoading) {
                return (
                    <div style={{ 
                        display: 'flex', 
                        justifyContent: 'center', 
                        alignItems: 'center', 
                        minHeight: '100vh',
                        color: 'var(--color-text-primary)'
                    }}>
                        Loading...
                    </div>
                );
            }

            if (!user) {
                return <LoginView onLogin={setUser} />;
            }

            return (
                <div className="app-container">
                    {/* Desktop Sidebar */}
                    <Sidebar 
                        currentView={currentView} 
                        setCurrentView={setCurrentView}
                        userRole={userRole}
                        setUserRole={setUserRole}
                    />

                    {/* Mobile Header */}
                    <div className="mobile-header">
                        <div className="mobile-header-content">
                            <div className="mobile-logo">
                                <div className="mobile-logo-icon"></div>
                                <span>ExpenseFlow</span>
                            </div>
                            <div className="user-badge">
                                <span></span>
                                <span className="role-indicator">
                                    {userRole === 'manager' ? 'MGR' : 'STAFF'}
                                </span>
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <div className="main-content">
                        {currentView === 'dashboard' && (
                            <Dashboard 
                                timeView={timeView}
                                setTimeView={setTimeView}
                                userRole={userRole}
                                expenses={expenses}
                                expandedWidgets={expandedWidgets}
                                toggleWidget={toggleWidget}
                                approveExpense={approveExpense}
                                lastWeekExpenses={lastWeekExpenses}
                                thisWeekExpenses={thisWeekExpenses}
                                nextWeekExpenses={nextWeekExpenses}
                                lastWeekTotal={lastWeekTotal}
                                lastWeekPaidTotal={lastWeekPaidTotal}
                                thisWeekTotal={thisWeekTotal}
                                nextWeekTotal={nextWeekTotal}
                                pendingApprovals={pendingApprovals}
                            />
                        )}
                        {currentView === 'calendar' && (
                            <CalendarView expenses={expenses} />
                        )}
                        {currentView === 'analytics' && userRole === 'manager' && (
                            <AnalyticsView expenses={expenses} />
                        )}
                        {currentView === 'setup' && (
                            <SetupView expenses={expenses} setExpenses={setExpenses} />
                        )}
                    </div>

                    {/* Mobile Bottom Navigation */}
                    <div className="mobile-bottom-nav">
                        <div className="mobile-bottom-nav-grid">
                            <div 
                                className={`mobile-nav-item ${currentView === 'dashboard' ? 'active' : ''}`}
                                onClick={() => setCurrentView('dashboard')}
                            >
                                <span className="nav-icon"></span>
                                <span>Dashboard</span>
                            </div>
                            <div 
                                className={`mobile-nav-item ${currentView === 'calendar' ? 'active' : ''}`}
                                onClick={() => setCurrentView('calendar')}
                            >
                                <span className="nav-icon"></span>
                                <span>Calendar</span>
                            </div>
                            {userRole === 'manager' && (
                                <div 
                                    className={`mobile-nav-item ${currentView === 'analytics' ? 'active' : ''}`}
                                    onClick={() => setCurrentView('analytics')}
                                >
                                    <span className="nav-icon"></span>
                                    <span>Analytics</span>
                                </div>
                            )}
                            {userRole === 'manager' && (
                                <div 
                                    className={`mobile-nav-item ${currentView === 'setup' ? 'active' : ''}`}
                                    onClick={() => setCurrentView('setup')}
                                >
                                    <span className="nav-icon"></span>
                                    <span>Setup</span>
                                </div>
                            )}
                        </div>
                    </div>

                    {/* Install Prompt */}
                    {showInstallPrompt && (
                        <div className="install-prompt">
                            <div className="install-prompt-text">
                                <div className="install-prompt-title">Install ExpenseFlow</div>
                                <div className="install-prompt-subtitle">Add to your home screen for quick access</div>
                            </div>
                            <button className="install-btn" onClick={handleInstallClick}>
                                Install
                            </button>
                            <button className="install-close" onClick={() => setShowInstallPrompt(false)}>
                                
                            </button>
                        </div>
                    )}
                </div>
            );
        };

        const Sidebar = ({ currentView, setCurrentView, userRole, setUserRole }) => {
            return (
                <div className="sidebar">
                    <div className="logo">
                        <div className="logo-icon"></div>
                        <span>ExpenseFlow</span>
                    </div>
                    
                    <div style={{ padding: '0 32px 32px' }}>
                        <div className="user-badge">
                            <span></span>
                            <span>John Doe</span>
                            <span className="role-indicator">
                                {userRole === 'manager' ? 'MANAGER' : 'STAFF'}
                            </span>
                        </div>
                    </div>

                    <div className={`nav-item ${currentView === 'dashboard' ? 'active' : ''}`} 
                         onClick={() => setCurrentView('dashboard')}>
                        <span className="nav-icon"></span>
                        <span>Dashboard</span>
                    </div>
                    
                    <div className={`nav-item ${currentView === 'calendar' ? 'active' : ''}`} 
                         onClick={() => setCurrentView('calendar')}>
                        <span className="nav-icon"></span>
                        <span>Calendar View</span>
                    </div>
                    
                    {userRole === 'manager' && (
                        <div className={`nav-item ${currentView === 'analytics' ? 'active' : ''}`} 
                             onClick={() => setCurrentView('analytics')}>
                            <span className="nav-icon"></span>
                            <span>Analytics</span>
                        </div>
                    )}
                    
                    {userRole === 'manager' && (
                        <div className={`nav-item ${currentView === 'setup' ? 'active' : ''}`} 
                             onClick={() => setCurrentView('setup')}>
                            <span className="nav-icon"></span>
                            <span>Setup</span>
                        </div>
                    )}

                    <div style={{ marginTop: 'auto', padding: '20px 32px', borderTop: '1px solid var(--color-border)' }}>
                        <button 
                            className="btn btn-secondary" 
                            style={{ width: '100%' }}
                            onClick={() => setUserRole(userRole === 'manager' ? 'staff' : 'manager')}
                        >
                            Switch to {userRole === 'manager' ? 'Staff' : 'Manager'}
                        </button>
                    </div>
                </div>
            );
        };

        // Dashboard, ExpenseWidget, CalendarView, AnalyticsView, SetupView components remain the same as before
        // Due to character limit, I'm referencing the previous implementation
        // Copy all the component code from the previous version here

        const Dashboard = ({ 
            timeView, setTimeView, userRole, expenses, 
            expandedWidgets, toggleWidget, approveExpense,
            lastWeekExpenses, thisWeekExpenses, nextWeekExpenses,
            lastWeekTotal, lastWeekPaidTotal, thisWeekTotal, nextWeekTotal,
            pendingApprovals
        }) => {
            return (
                <>
                    <div className="header">
                        <div className="header-title">
                            <h1>Expense Dashboard</h1>
                            <p>Manage and track restaurant expenses</p>
                        </div>
                        <div className="header-actions">
                            {userRole === 'manager' && (
                                <button className="btn btn-primary">
                                    <span>+</span>
                                    <span>Add Expense</span>
                                </button>
                            )}
                        </div>
                    </div>

                    <div className="view-tabs">
                        <button 
                            className={`tab ${timeView === 'daily' ? 'active' : ''}`}
                            onClick={() => setTimeView('daily')}
                        >
                            Daily
                        </button>
                        <button 
                            className={`tab ${timeView === 'weekly' ? 'active' : ''}`}
                            onClick={() => setTimeView('weekly')}
                        >
                            Weekly
                        </button>
                        <button 
                            className={`tab ${timeView === 'monthly' ? 'active' : ''}`}
                            onClick={() => setTimeView('monthly')}
                        >
                            Monthly
                        </button>
                    </div>

                    {userRole === 'manager' ? (
                        <>
                            <div className="stats-grid">
                                <div className="stat-card">
                                    <div className="stat-label">Last Week Performance</div>
                                    <div className="stat-value">
                                        ${lastWeekPaidTotal.toLocaleString()} / ${lastWeekTotal.toLocaleString()}
                                    </div>
                                    <div className="stat-subtext">
                                        <span></span>
                                        {lastWeekTotal > 0 ? Math.round((lastWeekPaidTotal / lastWeekTotal) * 100) : 0}% paid on time
                                    </div>
                                </div>

                                <div className="stat-card">
                                    <div className="stat-label">This Week Total</div>
                                    <div className="stat-value">${thisWeekTotal.toLocaleString()}</div>
                                    <div className="stat-subtext">{thisWeekExpenses.length} expenses</div>
                                </div>

                                <div className="stat-card">
                                    <div className="stat-label">Next Week Planned</div>
                                    <div className="stat-value">${nextWeekTotal.toLocaleString()}</div>
                                    <div className="stat-subtext">{nextWeekExpenses.length} expenses</div>
                                </div>

                                <div className="stat-card">
                                    <div className="stat-label">Pending Approvals</div>
                                    <div className="stat-value" style={{ color: 'var(--color-warning)' }}>{pendingApprovals}</div>
                                    <div className="stat-subtext warning">
                                        <span className="pulse"></span>
                                        Need attention
                                    </div>
                                </div>
                            </div>

                            <div className="widgets-grid">
                                <ExpenseWidget 
                                    title="Last Week vs Paid"
                                    amount={lastWeekPaidTotal}
                                    subtitle={`${lastWeekExpenses.length} expenses`}
                                    expenses={lastWeekExpenses}
                                    expanded={expandedWidgets.lastWeek}
                                    onToggle={() => toggleWidget('lastWeek')}
                                    showApprove={false}
                                />

                                <ExpenseWidget 
                                    title="This Week Coming Up"
                                    amount={thisWeekTotal}
                                    subtitle={`${thisWeekExpenses.length} expenses`}
                                    expenses={thisWeekExpenses}
                                    expanded={expandedWidgets.thisWeek}
                                    onToggle={() => toggleWidget('thisWeek')}
                                    onApprove={approveExpense}
                                    showApprove={true}
                                />

                                <ExpenseWidget 
                                    title="Next Week Planned"
                                    amount={nextWeekTotal}
                                    subtitle={`${nextWeekExpenses.length} expenses`}
                                    expenses={nextWeekExpenses}
                                    expanded={expandedWidgets.nextWeek}
                                    onToggle={() => toggleWidget('nextWeek')}
                                    onApprove={approveExpense}
                                    showApprove={true}
                                />
                            </div>
                        </>
                    ) : (
                        <div className="widgets-grid" style={{ gridTemplateColumns: '1fr' }}>
                            <ExpenseWidget 
                                title="This Week Coming Up"
                                amount={thisWeekTotal}
                                subtitle={`${thisWeekExpenses.length} expenses`}
                                expenses={thisWeekExpenses}
                                expanded={true}
                                onToggle={() => {}}
                                showApprove={false}
                                showStatus={true}
                            />
                        </div>
                    )}
                </>
            );
        };

        const ExpenseWidget = ({ 
            title, amount, subtitle, expenses, expanded, onToggle, 
            onApprove, showApprove, showStatus
        }) => {
            return (
                <div className="widget">
                    <div className="widget-header">
                        <div className="widget-title">{title}</div>
                        <button className="expand-btn" onClick={onToggle}>
                            {expanded ? '' : ''}
                        </button>
                    </div>
                    <div className="widget-amount">${amount.toLocaleString()}</div>
                    <div className="widget-subtitle">{subtitle}</div>

                    {expanded && (
                        <div className="expense-list">
                            {expenses.length === 0 ? (
                                <div style={{ textAlign: 'center', color: 'var(--color-text-tertiary)', padding: '32px' }}>
                                    No expenses for this period
                                </div>
                            ) : (
                                expenses.map(expense => (
                                    <div key={expense.id} className="expense-item">
                                        <div className="expense-info">
                                            <div className="expense-name">{expense.name}</div>
                                            <div className="expense-meta">
                                                {expense.category}  {new Date(expense.dueDate).toLocaleDateString()}
                                            </div>
                                        </div>
                                        <div className="expense-actions">
                                            <div className="expense-amount">${expense.amount.toLocaleString()}</div>
                                            {showStatus && (
                                                <span className={`badge ${
                                                    expense.status === 'approved' ? 'badge-success' : 
                                                    expense.status === 'paid' ? 'badge-success' : 
                                                    'badge-pending'
                                                }`}>
                                                    {expense.status === 'approved' ? ' Approved' : 
                                                     expense.status === 'paid' ? ' Paid' : 
                                                     'Pending'}
                                                </span>
                                            )}
                                            {showApprove && expense.status === 'pending' && (
                                                <button 
                                                    className="approve-btn"
                                                    onClick={() => onApprove(expense.id)}
                                                >
                                                    Approve
                                                </button>
                                            )}
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>
                    )}
                </div>
            );
        };

        const CalendarView = ({ expenses }) => {
            const [currentMonth] = useState(new Date('2026-01-01'));
            const [selectedDay, setSelectedDay] = useState(null);
            
            const getDaysInMonth = () => {
                const year = currentMonth.getFullYear();
                const month = currentMonth.getMonth();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const days = [];
                
                const firstDayOfWeek = firstDay.getDay();
                for (let i = 0; i < firstDayOfWeek; i++) {
                    days.push(null);
                }
                
                for (let i = 1; i <= lastDay.getDate(); i++) {
                    const date = new Date(year, month, i);
                    const dateStr = date.toISOString().split('T')[0];
                    const dayExpenses = expenses.filter(e => e.dueDate === dateStr);
                    const total = dayExpenses.reduce((sum, e) => sum + e.amount, 0);
                    
                    days.push({
                        date: i,
                        fullDate: dateStr,
                        expenses: dayExpenses,
                        total
                    });
                }
                
                return days;
            };

            const days = getDaysInMonth();
            const weekDays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

            return (
                <>
                    <div className="header">
                        <div className="header-title">
                            <h1>Calendar View</h1>
                            <p>January 2026</p>
                        </div>
                    </div>

                    <div className="calendar-grid">
                        {weekDays.map(day => (
                            <div key={day} className="calendar-header">
                                {day}
                            </div>
                        ))}
                        
                        {days.map((day, index) => (
                            day ? (
                                <div 
                                    key={index} 
                                    className={`calendar-day ${day.expenses.length > 0 ? 'has-expense' : ''}`}
                                    onClick={() => day.expenses.length > 0 && setSelectedDay(day)}
                                    style={{ cursor: day.expenses.length > 0 ? 'pointer' : 'default' }}
                                >
                                    <div className="day-number">{day.date}</div>
                                    {day.total > 0 && (
                                        <>
                                            <div className="day-amount">${day.total.toLocaleString()}</div>
                                            <div style={{ fontSize: '11px', color: 'var(--color-text-tertiary)' }}>
                                                {day.expenses.length} item{day.expenses.length > 1 ? 's' : ''}
                                            </div>
                                        </>
                                    )}
                                </div>
                            ) : (
                                <div key={index}></div>
                            )
                        ))}
                    </div>

                    {selectedDay && (
                        <div className="modal-overlay" onClick={() => setSelectedDay(null)}>
                            <div className="modal-content" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <div style={{ flex: 1 }}>
                                        <div className="modal-title">
                                            {new Date(selectedDay.fullDate).toLocaleDateString('en-US', { 
                                                weekday: 'long', 
                                                year: 'numeric', 
                                                month: 'long', 
                                                day: 'numeric' 
                                            })}
                                        </div>
                                        <p style={{ color: 'var(--color-text-secondary)', marginTop: '8px', fontSize: '16px' }}>
                                            Total: <span style={{ color: 'var(--color-primary)', fontWeight: 700 }}>${selectedDay.total.toLocaleString()}</span>
                                        </p>
                                    </div>
                                    <button className="modal-close" onClick={() => setSelectedDay(null)}>
                                        
                                    </button>
                                </div>
                                
                                <div className="expense-list">
                                    {selectedDay.expenses.map(expense => (
                                        <div key={expense.id} className="expense-item">
                                            <div className="expense-info">
                                                <div className="expense-name">{expense.name}</div>
                                                <div className="expense-meta">
                                                    {expense.category}  {expense.frequency}
                                                </div>
                                            </div>
                                            <div className="expense-actions">
                                                <div className="expense-amount">${expense.amount.toLocaleString()}</div>
                                                <span className={`badge ${
                                                    expense.status === 'approved' ? 'badge-success' : 
                                                    expense.status === 'paid' ? 'badge-success' : 
                                                    'badge-pending'
                                                }`}>
                                                    {expense.status === 'approved' ? ' Approved' : 
                                                     expense.status === 'paid' ? ' Paid' : 
                                                     'Pending'}
                                                </span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}
                </>
            );
        };

        // AnalyticsView and SetupView - keeping the same implementation from before
        // (Character limit reached - these remain unchanged from the supercharged version)

        const AnalyticsView = ({ expenses }) => {
            return (
                <div className="header">
                    <div className="header-title">
                        <h1>Analytics & Insights</h1>
                        <p>Coming soon with full analytics dashboard</p>
                    </div>
                </div>
            );
        };

        const SetupView = ({ expenses, setExpenses }) => {
            return (
                <div className="header">
                    <div className="header-title">
                        <h1>Expense Setup</h1>
                        <p>Coming soon with full setup interface</p>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registered:', registration);
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed:', err);
                    });
            });
        }
    </script>
</body>
</html>